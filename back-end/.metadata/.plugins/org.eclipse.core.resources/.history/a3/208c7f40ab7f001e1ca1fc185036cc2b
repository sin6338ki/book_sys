package com.sjy.book_sys.service;

import java.sql.SQLIntegrityConstraintViolationException;

import org.springframework.stereotype.Service;

import com.sjy.book_sys.mapper.BookMapper;
import com.sjy.book_sys.model.Book;
import com.sjy.book_sys.model.BookRegDto;

import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;

/**
 * Book(도서) 관련 Service
 * @author 신지영
 * @since 2023.11.10
 */
@Slf4j
@RequiredArgsConstructor
@Service
public class BookService {
	
	private final BookMapper bookMapper;
	
	/**
	 * 책 등록 service
	 * @param bookRegDto
	 * @return success / fail
	 * @throws SQLIntegrityConstraintViolationException 
	 */
	public String regBook(BookRegDto bookRegDto) {
		try {
	        int regResult = bookMapper.regBook(bookRegDto);
	        if(regResult>0) {
	            return "success book registration";
	        } else {
	            throw new SQLIntegrityConstraintViolationException("exist null");
	        }
	    } catch(SQLIntegrityConstraintViolationException e) {
	        // 이 부분에서 예외를 처리합니다. 예를 들어, 로그를 출력하거나 사용자에게 메시지를 전달할 수 있습니다.
	        System.err.println("무결성 제약 조건 위반: " + e.getMessage());
	        return "fail book registration due to SQLIntegrityConstraintViolationException";
	    }
	}
}
